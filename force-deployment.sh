#!/bin/bash

echo "ðŸš€ FORZANDO DESPLIEGUE EN JENKINS"
echo "================================="
echo ""

echo "ðŸ“‹ CAMBIOS REALIZADOS:"
echo "   âœ… Removidas condiciones 'when' de las etapas de despliegue"
echo "   âœ… Deploy to Development: Ahora se ejecuta SIEMPRE"
echo "   âœ… Deploy to Production: Ahora se ejecuta SIEMPRE"
echo "   âœ… Deploy to QA: Solo se ejecuta en branch QA"
echo ""

echo "ðŸ”§ COMANDOS QUE SE EJECUTARÃN:"
echo "   â€¢ docker tag hospital-registry/hospital-backend:22 hospital-registry/hospital-backend:dev"
echo "   â€¢ docker tag hospital-registry/hospital-frontend:22 hospital-registry/hospital-frontend:dev"
echo "   â€¢ docker compose down"
echo "   â€¢ docker compose up -d"
echo "   â€¢ docker tag hospital-registry/hospital-backend:22 hospital-registry/hospital-backend:prod"
echo "   â€¢ docker tag hospital-registry/hospital-frontend:22 hospital-registry/hospital-frontend:prod"
echo "   â€¢ docker compose -f docker-compose.prod.yml down"
echo "   â€¢ docker compose -f docker-compose.prod.yml up -d"
echo ""

echo "ðŸŽ¯ PRÃ“XIMOS PASOS:"
echo ""

echo "1ï¸âƒ£  Ve a Jenkins: http://localhost:8081"
echo ""

echo "2ï¸âƒ£  Ve a tu pipeline 'Hospital-CI-CD'"
echo ""

echo "3ï¸âƒ£  Haz clic en 'Build Now' para ejecutar el pipeline"
echo ""

echo "4ï¸âƒ£  Ahora deberÃ­as ver que TODAS las etapas se ejecutan:"
echo "   âœ… Checkout SCM"
echo "   âœ… Checkout"
echo "   âœ… Setup Tools"
echo "   âœ… Build Backend"
echo "   âœ… Test Backend"
echo "   âœ… Build Frontend"
echo "   âœ… Build Docker Images"
echo "   âœ… Deploy to Development (NUEVO - se ejecutarÃ¡)"
echo "   âœ… Deploy to Production (NUEVO - se ejecutarÃ¡)"
echo "   âœ… Post Actions"
echo ""

echo "ðŸ” VERIFICACIÃ“N DESPUÃ‰S DEL DESPLIEGUE:"
echo "   Una vez completado, verifica:"
echo "   â€¢ Frontend: http://localhost:80"
echo "   â€¢ Backend: http://localhost:8080"
echo "   â€¢ Database: localhost:1521"
echo ""

echo "âš ï¸  IMPORTANTE:"
echo "   Si las etapas siguen sin ejecutarse, puede ser que Jenkins"
echo "   tenga cache del Jenkinsfile anterior. En ese caso:"
echo "   1. Ve a 'Manage Jenkins' > 'Manage Plugins'"
echo "   2. Busca 'Pipeline' y reinstala el plugin"
echo "   3. Reinicia Jenkins"
echo ""

echo "âœ… ESTADO: Listo para forzar despliegue"
echo "" 